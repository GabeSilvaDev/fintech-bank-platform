# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PKG - Makefile
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.PHONY: help test test-coverage clean fmt lint docker-up docker-down docker-test docker-coverage

help:
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo "  PKG - Pacotes Compartilhados - Comandos DisponÃ­veis"
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo ""
	@echo "  Local:"
	@echo "    make test            - Roda todos os testes"
	@echo "    make test-coverage   - Gera relatÃ³rio de cobertura"
	@echo "    make fmt             - Formata o cÃ³digo"
	@echo "    make lint            - Verifica formataÃ§Ã£o"
	@echo "    make clean           - Remove arquivos gerados"
	@echo ""
	@echo "  Docker:"
	@echo "    make docker-up       - Sobe container fintech-pkg"
	@echo "    make docker-down     - Para container fintech-pkg"
	@echo "    make docker-test     - Roda testes no container"
	@echo "    make docker-coverage - Gera coverage no container"
	@echo ""

test:
	@echo "ğŸ§ª Rodando testes..."
	@go test -v ./...

test-coverage:
	@echo "ğŸ“Š Gerando relatÃ³rio de cobertura..."
	@go test -coverprofile=coverage.out ./...
	@go tool cover -html=coverage.out -o coverage.html
	@go tool cover -func=coverage.out
	@echo ""
	@echo "âœ… RelatÃ³rio gerado: coverage.html"

fmt:
	@echo "ğŸ¨ Formatando cÃ³digo..."
	@gofmt -w .
	@echo "âœ… CÃ³digo formatado"

lint:
	@echo "ğŸ” Verificando formataÃ§Ã£o..."
	@if [ -n "$$(gofmt -l .)" ]; then \
		echo "âŒ CÃ³digo nÃ£o formatado:"; \
		gofmt -l .; \
		exit 1; \
	fi
	@echo "âœ… CÃ³digo formatado corretamente"

clean:
	@rm -f coverage.out coverage.html
	@echo "ğŸ§¹ Arquivos limpos"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DOCKER COMMANDS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

docker-up:
	@echo "ğŸ³ Subindo container fintech-pkg..."
	@docker compose up -d --build
	@echo "âœ… Container fintech-pkg rodando"

docker-down:
	@echo "ğŸ³ Parando container fintech-pkg..."
	@docker compose down
	@echo "âœ… Container parado"

docker-test:
	@echo "ğŸ§ª Rodando testes no container..."
	@docker exec fintech-pkg go test -v -cover ./...

docker-coverage:
	@echo "ğŸ“Š Gerando coverage no container..."
	@docker exec fintech-pkg sh -c "go test -coverprofile=coverage.out ./... && go tool cover -func=coverage.out"
